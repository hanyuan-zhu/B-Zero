# 需求文档v0.1 - 围绕工资生成


### 目标
搭建一个日常工作管理工具，用户可以通过自然语言对话完成所有相关的工作。

### 用户
公司内部人员


## 3. 产品功能架构
工具将包含两个部分：
1. **传统管理系统**
   - 前端：用户界面
   - 后端：API和业务逻辑
   - 数据库：数据存储

2. **AI模块**
   - 通过自然语言处理（基于当前LLM）完成相应操作，大部分功能通过调用后端API实现。

## 4. 功能需求

### 4.0 注册登录和账号管理

### 4.1 人员管理模块

#### 4.1.1 人员信息管理

**功能概述**
管理公司、部门和项目的人员信息，包括入职、离职、调岗等操作，支持人员历史记录的查看。

**权限管理**
- 普通员工可查看个人信息。
- 公司管理员可管理所有人员信息。

**功能需求**

1. **人员名单管理**
   - 查看当前公司、部门或项目下所有在岗人员名单，包含姓名、职位、部门等基本信息。
   - 查看历史变动记录：入职、部门调动、项目调岗、离职的时间和原因。
   - 待确认变动表格
   - 变动历史记录表格
   - 搜索栏（用于过滤历史记录）
   - 确认按钮（针对待确认变动）
   - 拒绝按钮（针对待确认变动）

**人员字段**
- 员工ID (int，主键)
- 姓名 (varchar)
- 职位 (varchar)
- 部门 (varchar)
- 项目 (varchar)
- 入职日期 (date)
- 最近调岗生效日期 (date)
- 在职状态（在职，待岗，离职）

**相关字段**
- 变动ID (int，主键)

**交互功能**
- 页面顶部的标签导航：“人员名单”和“变动记录”两个标签
- 待确认变动表格
  - 仅在有待确认变动时显示
  - 每行显示一条待确认的变动记录
  - 每行末尾有"确认"和"拒绝"按钮
  - 点击"确认"按钮将变动状态更新为已确认，并移至历史记录表格
  - 点击"拒绝"按钮将删除该变动记录
- 变动历史记录表格
  - 始终显示，即使没有历史记录
  - 显示所有已确认的变动记录
- 搜索功能
  - 位于变动历史记录表格上方
  - 用户可以输入关键词搜索员工、变动类型或原因
  - 搜索结果实时更新在历史记录表格中

2. **人员变动操作**
   - 入职流程：录入新员工信息，选择所属部门或项目，填写入职时间，提交审批。
   - 离职流程：选择离职人员，填写离职原因，提交审批。
   - 项目调岗流程：选择调岗人员，填写新部门或项目，调岗原因，提交审批。
   - 部门调动流程：选择调动人员，选择所属新部门，提交审批。

**2.1 入职流程**
1. “添加新员工”发起
2. 弹窗填写新员工信息
   - “入职项目”若留空，员工就是“待岗”状态。
3. “确认”后添加到“变动记录”页面里待确认

**2.2 离职流程**
- 发起和最终确认页面可以参考“入职流程”

**交互功能**
- 弹窗触发：
  - 人员列表中每行的“离职”按钮
  - 右下角浮动按钮中的“人员离职”选项

**员工信息区域**
- 员工姓名：下拉选择（当从列表触发时为禁用状态）
- 所在项目：只读显示
- 所在公司：只读显示
- 当前状态：只读显示（在职/待岗）

**离职信息输入**
- 离职生效日期：日期选择器
- 离职原因：多行文本输入框

**操作按钮**
- 提交：提交离职申请
- 取消：关闭弹窗

**2.3 项目调岗流程**
- 注意：这里选择部门，是为了选择部门下所属的项目，人员不会发生“部门”变更。

**交互功能**
- 发起流程：
  - 提供两个入口：人员列表中每行的“调岗”按钮和右下角浮动操作按钮中的“人员项目调岗”选项
  - 打开模态框进行项目调岗操作
  - 显示员工当前部门和项目信息
  - 允许选择新部门和相应的新项目
  - 记录调岗生效日期和原因

**相关字段**
- 员工姓名（如从列表进入则预填且不可更改）
- 现在部门（只读）
- 现在项目（只读）
- 新部门（下拉选择）
- 新项目（下拉选择，根据所选新部门动态更新可选项）
- 到岗生效日期
- 调岗原因

**交互功能**
- 发起流程：
  - 提供两个入口：人员列表中每行的“调动”按钮和右下角浮动操作按钮中的“人员部门调动”选项
  - 打开模态框进行部门调动操作
  - 显示员工当前部门信息
  - 允许选择新部门
  - 记录调动生效日期和原因

**相关字段**
- 员工姓名（如从列表进入则预填且不可更改）
- 现在部门（只读）
- 新部门（下拉选择）
- 生效日期
- 调动原因

#### 4.1.2 人员合同管理

**功能概述**
管理人员合同信息，包括合同查看、创建与变更。

**权限管理**
- 普通员工可查看个人合同信息。
- 公司管理员可查看和变更所有合同信息。

**功能需求**

1. **合同信息展示**
   - 展示合同关键字段：姓名、所属公司、合同薪资、生效日期、有效期、合同文件。
   - 支持按部门或项目筛选合同档案。

2. **合同创建与变更**
   - 创建新合同：录入必填字段（如姓名、合同薪资、生效日期等），上传电子文件。
   - 合同变更：更新合同薪资、生效日期等信息，上传变更文件，并存储版本记录。

3. **查看合同历史记录**

4. **合同筛选和搜索**

**交互功能**
- 新建合同功能
  - 通过模态框形式打开新建合同表单
  - 姓名、所属公司、部门、项目、合同薪资、生效日期、到期日期、合同文件上传
  - 创建新合同
- 编辑合同功能
  - 通过模态框形式打开编辑合同表单
  - 表单预填充当前合同信息
  - 提供合同变更文件上传功能
  - 可编辑字段与新建合同相同
  - 变更合同
- 查看合同历史记录
  - 通过模态框形式展示特定员工的所有合同版本
  - 版本号、生效日期、到期日期、薪资、部门、项目、变更日期、变更原因
  - 查看合同历史
- 合同筛选和搜索
  - 提供按部门和项目筛选的下拉菜单
  - 提供搜索输入框，支持按关键词搜索合同

**其他注意**
- 使用模态框进行新建、编辑和查看历史操作，避免页面跳转
- 编辑操作实时更新合同列表
- 筛选和搜索操作即时更新合同列表显示

#### 4.1.3 人员考勤管理

**权限管理**
- 缺勤记录添加：仅公司管理员可操作
- 考勤查询：公司管理员可查看所有员工，普通员工仅可查看自己的记录

**功能需求**

1. **缺勤记录管理**
   - 添加缺勤记录，包含姓名、起止日期、原因。

2. **考勤查询**
   - 支持按姓名、部门、日期（一般是月份选择，最少一个月）等条件查询考勤记录。
   - 查询考勤记录的结果是一个表格，显示有人员名字，所属公司，应出勤天数，实际出勤天数，出勤率。

**功能**
- 添加员工缺勤记录
  - 表单提交后，系统保存缺勤记录
  - 提交成功后，显示成功提示，并清空表单
  - 姓名（必填，下拉选择）
  - 开始日期（必填，日期选择器）
  - 结束日期（必填，日期选择器）
  - 缺勤原因（必填，文本区域）
- 按条件查询员工考勤记录
  - 点击查询按钮后，根据筛选条件显示结果
  - 结果以表格形式展示
  - 支持表格排序（可选）
  - 查询条件：
    - 姓名（可选，文本输入）
    - 部门（可选，下拉选择）
    - 月份（必填，月份选择器）
  - 姓名
  - 所属公司
  - 应出勤天数
  - 实际出勤天数
  - 出勤率（百分比）

**数据处理**
- 缺勤记录添加后，系统自动更新相关员工的考勤统计

**未来优化方向**
- 集成请假申请流程
- 添加数据可视化图表
- 实现考勤异常自动提醒功能
- 为管理层提供部门级别的考勤报表

### 4.2 薪资管理模块

#### 4.2.1 工资表管理

**功能概述**
工资管理模块是公司管理工具的核心组成部分，旨在简化和自动化工资计算、审核和发放流程。该模块集成了税前工资计算、税金核算、税后工资确认以及历史工资查询等功能。

**权限管理**
- 总公司管理员可生成和查看所有工资表。

**功能需求**

- 税前工资表生成与确认
  - 根据部门和月份生成员工税前工资表
  - 用户选择部门和月份
  - 系统生成待确认的税前工资表
  - 用户审核并确认税前工资表
  - 姓名、基础工资、考勤系数、薪资奖扣额、社保个人缴纳额、公积金个人缴纳额、税前工资
  - 税前工资 = 基础工资 * 考勤系数 + 薪资奖扣额 - 社保个人缴纳额 - 公积金个人缴纳额

- 税后工资表生成并确认最终
  - 系统根据税前工资和税金信息生成税后工资表
  - 用户审核税后工资表
  - 用户确认最终的税后工资表

- 历史工资查询
  - 查询和导出历史工资记录
  - 查询条件：员工姓名、部门、月份
  - 展示字段：姓名、部门、月份、税后工资

**系统集成**
- 与考勤管理模块集成，获取员工考勤系数
- 与薪资奖扣管理模块集成，获取员工薪资奖扣信息
- 与社保公积金管理模块集成，获取员工社保和公积金缴纳信息

#### 4.2.2 薪资奖扣管理

**功能概述**
薪资奖扣管理功能允许人力资源部门添加、查询和管理员工的奖金、补贴、扣减和暂缓发放等薪资调整项目。

**权限管理**
- 仅限总公司管理员操作。

**功能需求**

1. **添加薪资奖扣项**
   - 输入类型（一次性补贴/奖励、扣除、周期性补贴、暂时扣押）、金额、生效日期。
   - 支持按个人、项目、公司添加。（即添加到个人，或者添加到整个项目下的所有人，或者添加给公司下的所有人）
   - 这些奖扣项将用于当月工资表生成和发放

**薪资奖扣类型**
- 一次性奖金
  - 金额
- 薪资扣减
  - 金额
- 定期补贴
  - 金额
  - 发放周期（每月/每两个月/每季度）
  - 开始日期
  - 结束日期
- 暂缓发放
  - 金额
  - 生效日期
  - 扣押状态（未返还/已返还）
  - 返还日期（如适用）

2. **记录查询**
   - 查询所有薪资调整记录，支持筛选和导出。

**交互功能**
- 添加奖扣项功能
  - 根据选择的奖扣项类型，动态显示相应的字段
  - 提交后，显示成功提示，并清空表单
  - 类型（下拉选择：一次性奖金/薪资扣减/定期补贴/暂缓发放）
  - 金额（数字输入）
  - 生效日期（日期选择器）
  - 适用对象（单选：个人/项目/公司）
  - 具体对象（下拉选择，根据适用对象动态加载选项）
  - 发放周期（仅定期补贴，下拉选择）
  - 结束日期（仅定期补贴，日期选择器）

- 奖扣记录查询功能
  - 查询：根据筛选条件过滤记录
  - 筛选条件
    - 类型
    - 开始日期
    - 结束日期
    - 适用对象
  - 导出：将当前查询结果导出为文件（具体格式待定）
  - 类型
  - 金额
  - 生效日期
  - 适用对象
  - 具体对象
  - 发放周期（仅定期补贴）
  - 结束日期（仅定期补贴）
  - 扣押状态（仅暂缓发放）

- 暂缓发放返还功能
  - 操作流程
    - 点击“返还”按钮
    - 弹出模态窗口
    - 输入返还生效日期
    - 更新扣押状态为"已返还"
    - 记录返还日期

### 4.3 社保公积金管理模块

**功能概述**
管理社保记录，包括变更名单确认、缴费金额输入、记录查看。

目前，“变更确认”和社保、公积金其他信息更新分离；实际购买金额（反应在工资表的数额）以上传的记录为基础。

**权限管理**
- 部门管理员仅查看本部门或项目社保记录。
- 公司管理员可以上传提交社保记录，确认社保记录，可管理查看所有社保记录。

**功能需求**

1. **购买名单变更确认**
   - 相关了流程：入职、离职、部门调动确认 -> 添加公积金和社保变更项（待确认）-> 确认后更新公积金社保名单。
   - 入职、离职、部门调动时，确认社保变更名单。
   - 显示待确认的社保公积金变更记录列表。

2. **社保记录管理**
   - 记录上传社保购买记录

3. **公积金记录管理**
   - 记录上传社保购买记录

4. **记录查询**
   - 查询和导出社保缴费记录，支持按月份、部门等筛选。

**交互功能或页面**
- 变更确认
  - 显示待确认的社保变更记录列表。
  - 姓名、原部门、新部门、变动日期。
  - 变更记录以表格形式展示。
  - 提供"确认"和"拒绝"两个操作按钮。

- 社保缴费记录页
  - 提供添加单条记录和批量上传功能。
  - 表格展示所有记录，支持分页、排序和搜索。
  - 每条记录提供编辑和删除操作，辑和删除操作直接在表格中进行。
  - 姓名、部门、缴费基数、个人缴纳、公司缴纳、缴纳日期。

- 添加记录
  - 社保和公积金分别有独立的添加记录表单。
  - 提供表单验证，确保数据完整性。
  - 姓名、部门、缴费基数、个人缴纳、公司缴纳、缴纳日期。

- 批量上传
  - 支持CSV或Excel文件上传。
  - 上传界面为模态框，包含文件选择和上传按钮。
  - 上传后显示处理结果，包括成功上传的记录数。

- 公积金记录页
  - 功能与社保缴费记录类似。
  - 提供添加单条记录和批量上传功能。
  - 表格展示所有记录，支持分页、排序和搜索。
  - 每条记录提供编辑和删除操作，辑和删除操作直接在表格中进行。
  - 姓名、部门、缴费基数、个人缴纳、公司缴纳、缴纳日期。

- 记录查询页
  - 支持同时查询社保和公积金记录。
  - 查询条件：姓名、部门、开始日期、结束日期、记录类型（社保/公积金/全部）。
  - 查询结果动态加载到页面下方的表格中。
  - 提供导出查询结果功能。
  - 姓名、部门、开始日期、结束日期、记录类型（社保/公积金/全部）。